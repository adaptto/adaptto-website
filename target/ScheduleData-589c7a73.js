import{b as t,i as a,n as e,k as n,u as s,v as r}from"./scripts.js";const i="en-GB",o={hour:"2-digit",minute:"2-digit",timeZone:"UTC"},c={dateStyle:"full"};function u(t){return t.toLocaleDateString(i,c)}function d(t){return t.toLocaleTimeString(i,o)}function l(t){const a=new Date(0);return a.setUTCMilliseconds(Math.round(86400*(t-25569)*1e3)),a}class y{day;start;end;entries}class p{day;track;start;end;title;duration;durationFAQ;type;speakers;talkPath}const f=["day","talk","break","other"];class k{days;constructor(t){this.days=t}getDays(){return this.days}getTalkEntry(t){return this.days.flatMap((t=>t.entries)).find((a=>a.talkPath===t))}}function h(t,a){const i=parseInt(t.Day,10)||0,o=parseInt(t.Track,10)||0,c=parseFloat(t.Start)||0,u=parseFloat(t.End)||0;let d=t.Entry;const y=parseInt(t.Duration,10)||0,k=parseInt(t.FAQ,10)||0,h=t.Type;let g=e(t.Speakers);if(0===i||0===c||0===u||!d||0===y||!f.includes(h))return;const m=l(c),w=l(u);let F;if("talk"===h){const t=function(t,a,e){let n;return n=s(t)?r(t):`/${a}/schedule/${t}`,e.getItem(n)}(d,m.getFullYear(),a);if(!t)return;F=t.path,d=n(t.title),0===g.length&&(g=t.getSpeakers())}return Object.assign(new p,{day:i,track:o,start:m,end:w,title:d,duration:y,durationFAQ:k,type:h,speakers:g,talkPath:F})}async function g(e){let n;const s=await fetch(e,t());if(s.ok){n=(await s.json()).data}const r=function(t,a){const e=new Map;return t.forEach((t=>{const n=h(t,a);if(n&&"day"!==n.type){let t=e.get(n.day);t||(t=[],e.set(n.day,t)),t.push(n)}})),Array.from(e.values()).map((t=>Object.assign(new y,{day:t[0].day,start:t.reduce(((t,a)=>a.start<t?a.start:t),t[0].start),end:t.reduce(((t,a)=>a.end>t?a.end:t),t[0].start),entries:t})))}(n||[],await a());return new k(r)}export{d as a,u as f,g};
